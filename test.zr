func run_test[x: String] : I64
    // TODO: escape sequences
    printf("\033[93mBuilding %s...\033[0m", x)
    let cmd: String = concat("./target/release/zern examples/", x)

    let build_start_time: I64 = OS.time()
    if system(cmd) != 0
        exit(1)
    let build_end_time: I64 = OS.time()

    free(cmd)
    printf(" %ldms\n", build_end_time - build_start_time)

    let run_start_time: I64 = OS.time()
    if system("./out") != 0
        exit(1)
    let run_end_time: I64 = OS.time()
    
    printf("\033[93mRunning %s...\033[0m %ldms\n", x, run_end_time - run_start_time)

func main[] : I64
    system("cargo build --release")

    let files: Array = OS.listdir("examples/")
    for i in 0:Array.size(files)
        let file: String = Array.nth(files, i)
        run_test(file)
        free(file)